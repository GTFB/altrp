# PostRepository

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

`PostRepository` - —ç—Ç–æ –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—Å—Ç–∞–º–∏ –±–ª–æ–≥–∞, –∫–æ—Ç–æ—Ä—ã–π —á–∏—Ç–∞–µ—Ç MDX —Ñ–∞–π–ª—ã –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø–æ–∏—Å–∫–∞.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### **–ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
- ‚úÖ **Frontmatter** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ YAML –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ **Markdown** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ Markdown –≤ HTML
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã frontmatter —Å –ø–æ–º–æ—â—å—é Zod
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - graceful fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø–∞—Ä—Å–∏–Ω–≥–∞

### **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫**
- ‚úÖ **–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ **–ü–æ —Ç–µ–≥–∞–º** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ç–µ–≥–∞–º
- ‚úÖ **–ü–æ –∞–≤—Ç–æ—Ä—É** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ –ø–æ –∞–≤—Ç–æ—Ä—É
- ‚úÖ **–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É** - –ø–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É, –æ–ø–∏—Å–∞–Ω–∏—é, excerpt –∏ —Ç–µ–≥–∞–º

### **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**
- ‚úÖ **–ü–æ –¥–∞—Ç–µ** - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- ‚úÖ **–ü–æ –∑–∞–≥–æ–ª–æ–≤–∫—É** - –∞–ª—Ñ–∞–≤–∏—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- ‚úÖ **–ü–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è** - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ **–ü–æ—Ä—è–¥–æ–∫** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–≥–æ –∏ —É–±—ã–≤–∞—é—â–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### **–ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**

```typescript
import { PostRepository } from '@/repositories/post.repository';

const postRepo = new PostRepository();

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ—Å—Ç—ã
const posts = await postRepo.findAll();

// –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç –ø–æ slug
const post = await postRepo.findBySlug('my-first-post');

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
const categories = await postRepo.findAllCategories();

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤
const authors = await postRepo.findAllAuthors();
```

### **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**

```typescript
// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
const tutorials = await postRepo.findByCategory('tutorials');

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∞–≤—Ç–æ—Ä—É
const johnPosts = await postRepo.findByAuthor('john-doe');

// –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
const filteredPosts = await postRepo.findWithFilters(
  {
    category: 'tutorials',
    tags: ['react', 'nextjs'],
    author: 'john-doe',
    search: 'MDX'
  },
  {
    field: 'date',
    order: 'desc'
  }
);
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
content/blog/
‚îú‚îÄ‚îÄ my-first-post/
‚îÇ   ‚îî‚îÄ‚îÄ index.mdx
‚îú‚îÄ‚îÄ another-post/
‚îÇ   ‚îî‚îÄ‚îÄ index.mdx
‚îî‚îÄ‚îÄ ...
```

## üìù –§–æ—Ä–º–∞—Ç MDX —Ñ–∞–π–ª–æ–≤

```markdown
---
title: My First Post
date: 2024-01-01
tags: [demo, hello]
excerpt: This is a demo post.
category: main-category
author: john-doe
---

# Hello MDX

This is content stored in Git.

## Features

- **Markdown** support
- **MDX** components
- **Frontmatter** metadata
```

## üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Markdown

Repository –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç `marked` —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```typescript
marked.setOptions({
  gfm: true,        // GitHub Flavored Markdown
  breaks: true,     // Convert \n to <br>
});
```

## üîç –ü–æ–∏—Å–∫

–ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø–æ–ª—è–º:
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫** (`title`)
- **–û–ø–∏—Å–∞–Ω–∏–µ** (`description`)
- **Excerpt** (`excerpt`)
- **–¢–µ–≥–∏** (`tags`)

–ü–æ–∏—Å–∫ –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ.

## üìä –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### **Post**
```typescript
interface Post {
  slug: string;
  title: string;
  description?: string;
  date?: string;
  tags?: string[];
  excerpt?: string;
  content?: string;  // HTML –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ Markdown
  category?: string;
  author?: string;
}
```

### **PostFilters**
```typescript
interface PostFilters {
  category?: string;
  tags?: string[];
  author?: string;
  search?: string;
}
```

### **PostSortOptions**
```typescript
interface PostSortOptions {
  field: 'date' | 'title' | 'created';
  order: 'asc' | 'desc';
}
```

## üöÄ API Routes

Repository –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Next.js API routes:

- `GET /api/posts` - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `GET /api/posts/[slug]` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Å—Ç
- `GET /api/posts/categories` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `GET /api/posts/authors` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ—Å—Ç—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –ø–æ—Å—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –ø–∞–º—è—Ç–∏** - –±—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## üõ†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ frontmatter:

1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ö–µ–º—É –≤ `src/lib/validators/content.schema.ts`
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Post`
3. –û–±–Ω–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ `findBySlug` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è
4. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –≤ `applyFilters` –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
